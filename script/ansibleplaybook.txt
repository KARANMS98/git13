---
- hosts: localhost
  become: true
  tasks:
    - name: add Jenkins repository
      apt_repository:
        name: Jenkins
        description: Jenkins Repository
        baseurl: https://pkg.jenkins.io/debian-stable
        gpgkey: https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key

    - name: install Java and Jenkins
      apt:
        name: "{{ item }}"
        state: present
        when: ansible_facts['pkg_mgr'] == 'apt'
      with_items:
        - java
        - jenkins

    #- name: change Jenkins port number
     # lineinfile:
      #  path: /etc/default/jenkins   # Adjust path if necessary
       # regexp: '^JENKINS_PORT='
        #line: 'JENKINS_PORT={{ jenkins_port }}'
      #notify: restart jenkins

    - name: start the Jenkins service
      service:
        name: jenkins
        state: started

  handlers:
    - name: restart jenkins
      service:
        name: jenkins
        state: restarted